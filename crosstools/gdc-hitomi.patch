diff -r 748ce286f58f d/d-spec.c
--- a/d/d-spec.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/d-spec.c	Fri Sep 09 23:26:27 2011 +0200
@@ -256,9 +256,11 @@
                     library = (library == 0) ? 1 : library;
                 break;
 
+#ifndef TARGET_HITOMI
             case OPT_pthread:
                 args[i] |= WITHTHREAD;
                 break;
+#endif
 
             case OPT_pg:
             case OPT_p:
diff -r 748ce286f58f d/dmd/mangle.c
--- a/d/dmd/mangle.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd/mangle.c	Fri Sep 09 23:26:27 2011 +0200
@@ -30,7 +30,7 @@
 #include "id.h"
 #include "module.h"
 
-#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
 char *cpp_mangle(Dsymbol *s);
 #endif
 
@@ -125,7 +125,7 @@
                     return ident->toChars();
 
                 case LINKcpp:
-#if DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS)
+#if DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI)
                     return cpp_mangle(this);
 #else
                     // Windows C++ mangling is done by C++ back end
diff -r 748ce286f58f d/dmd/mars.c
--- a/d/dmd/mars.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd/mars.c	Fri Sep 09 23:26:27 2011 +0200
@@ -66,7 +66,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     obj_ext  = "obj";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     obj_ext  = "o";
 #elif TARGET_NET
 #else
@@ -79,7 +79,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     lib_ext  = "lib";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     lib_ext  = "a";
 #elif TARGET_NET
 #else
@@ -92,7 +92,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     dll_ext  = "dll";
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     dll_ext  = "so";
 #elif TARGET_OSX
     dll_ext = "dylib";
@@ -386,7 +386,7 @@
 
 #if TARGET_WINDOS
     global.params.defaultlibname = "phobos";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     global.params.defaultlibname = "phobos";
 #elif TARGET_NET
 #else
@@ -426,6 +426,10 @@
     VersionCondition::addPredefinedGlobalIdent("Posix");
     VersionCondition::addPredefinedGlobalIdent("Solaris");
     global.params.isSolaris = 1;
+#elif TARGET_HITOMI
+    VersionCondition::addPredefinedGlobalIdent("Posix");
+    VersionCondition::addPredefinedGlobalIdent("Hitomi");
+    global.params.isHitomi = 1;
 #else
 #error "fix this"
 #endif
@@ -464,7 +468,7 @@
                 global.params.link = 0;
             else if (strcmp(p + 1, "cov") == 0)
                 global.params.cov = 1;
-#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
             else if (strcmp(p + 1, "fPIC") == 0)
                 global.params.pic = 1;
 #endif
diff -r 748ce286f58f d/dmd/mars.h
--- a/d/dmd/mars.h	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd/mars.h	Fri Sep 09 23:26:27 2011 +0200
@@ -56,6 +56,7 @@
         TARGET_FREEBSD  Covers 32 and 64 bit FreeBSD
         TARGET_OPENBSD  Covers 32 and 64 bit OpenBSD
         TARGET_SOLARIS  Covers 32 and 64 bit Solaris
+        TARGET_HITOMI   Covers 32 and 64 bit Hitomi
         TARGET_NET      Covers .Net
 
     It is expected that the compiler for each platform will be able
@@ -99,7 +100,7 @@
 #define MODULEINFO_IS_STRUCT DMDV2   // if ModuleInfo is a struct rather than a class
 
 // Set if C++ mangling is done by the front end
-#define CPP_MANGLE (DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS))
+#define CPP_MANGLE (DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI))
 
 /* Other targets are TARGET_LINUX, TARGET_OSX, TARGET_FREEBSD, TARGET_OPENBSD and
  * TARGET_SOLARIS, which are
@@ -111,7 +112,7 @@
 #define OMFOBJ 1
 #endif
 
-#if TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
 #ifndef ELFOBJ
 #define ELFOBJ 1
 #endif
@@ -151,6 +152,7 @@
     char isFreeBSD;     // generate code for FreeBSD
     char isOPenBSD;     // generate code for OpenBSD
     char isSolaris;     // generate code for Solaris
+    char isHitomi;      // generate code for Hitomi
     char scheduler;     // which scheduler to use
     char useDeprecated; // allow use of deprecated features
     char useAssert;     // generate runtime code for assert()'s
diff -r 748ce286f58f d/dmd/mtype.c
--- a/d/dmd/mtype.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd/mtype.c	Fri Sep 09 23:26:27 2011 +0200
@@ -86,7 +86,7 @@
 int REALSIZE = 16;
 int REALPAD = 6;
 int REALALIGNSIZE = 16;
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
 int REALSIZE = 12;
 int REALPAD = 2;
 int REALALIGNSIZE = 4;
@@ -253,7 +253,7 @@
     if (global.params.isX86_64)
     {
         PTRSIZE = 8;
-        if (global.params.isLinux || global.params.isFreeBSD || global.params.isSolaris)
+        if (global.params.isLinux || global.params.isFreeBSD || global.params.isSolaris || global.params.isHitomi)
         {
             REALSIZE = 16;
             REALPAD = 6;
@@ -268,7 +268,7 @@
 #if TARGET_OSX
         REALSIZE = 16;
         REALPAD = 6;
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
         REALSIZE = 12;
         REALPAD = 2;
 #else
@@ -1108,7 +1108,7 @@
             sz = REALALIGNSIZE;
             break;
 
-#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
         case Tint64:
         case Tuns64:
             sz = global.params.isX86_64 ? 8 : 4;
diff -r 748ce286f58f d/dmd2/mangle.c
--- a/d/dmd2/mangle.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd2/mangle.c	Fri Sep 09 23:26:27 2011 +0200
@@ -30,7 +30,7 @@
 #include "id.h"
 #include "module.h"
 
-#if IN_GCC || TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if IN_GCC || TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
 char *cpp_mangle(Dsymbol *s);
 #endif
 
diff -r 748ce286f58f d/dmd2/mars.c
--- a/d/dmd2/mars.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd2/mars.c	Fri Sep 09 23:26:27 2011 +0200
@@ -71,7 +71,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     obj_ext  = "obj";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     obj_ext  = "o";
 #elif TARGET_NET
 #else
@@ -84,7 +84,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     lib_ext  = "lib";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     lib_ext  = "a";
 #elif TARGET_NET
 #else
@@ -97,7 +97,7 @@
 #ifndef IN_GCC
 #if TARGET_WINDOS
     dll_ext  = "dll";
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     dll_ext  = "so";
 #elif TARGET_OSX
     dll_ext = "dylib";
@@ -398,7 +398,7 @@
 
 #if TARGET_WINDOS
     global.params.defaultlibname = "phobos";
-#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#elif TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
     global.params.defaultlibname = "phobos2";
 #elif TARGET_NET
 #else
@@ -438,6 +438,10 @@
     VersionCondition::addPredefinedGlobalIdent("Posix");
     VersionCondition::addPredefinedGlobalIdent("Solaris");
     global.params.isSolaris = 1;
+#elif TARGET_HITOMI
+    VersionCondition::addPredefinedGlobalIdent("Posix");
+    VersionCondition::addPredefinedGlobalIdent("Hitomi");
+    global.params.isHitomi = 1;
 #else
 #error "fix this"
 #endif
@@ -476,7 +480,7 @@
                 global.params.link = 0;
             else if (strcmp(p + 1, "cov") == 0)
                 global.params.cov = 1;
-#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
             else if (strcmp(p + 1, "fPIC") == 0)
                 global.params.pic = 1;
 #endif
diff -r 748ce286f58f d/dmd2/mars.h
--- a/d/dmd2/mars.h	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd2/mars.h	Fri Sep 09 23:26:27 2011 +0200
@@ -56,6 +56,7 @@
         TARGET_FREEBSD  Covers 32 and 64 bit FreeBSD
         TARGET_OPENBSD  Covers 32 and 64 bit OpenBSD
         TARGET_SOLARIS  Covers 32 and 64 bit Solaris
+        TARGET_HITOMI   Covers 32 and 64 bit Hitomi
         TARGET_NET      Covers .Net
 
     It is expected that the compiler for each platform will be able
@@ -104,7 +105,7 @@
 #define MODULEINFO_IS_STRUCT DMDV2   // if ModuleInfo is a struct rather than a class
 
 // Set if C++ mangling is done by the front end
-#define CPP_MANGLE (DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS))
+#define CPP_MANGLE (DMDV2 && (TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI))
 
 /* Other targets are TARGET_LINUX, TARGET_OSX, TARGET_FREEBSD, TARGET_OPENBSD and
  * TARGET_SOLARIS, which are
@@ -116,7 +117,7 @@
 #define OMFOBJ 1
 #endif
 
-#if TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS
+#if TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_HITOMI
 #ifndef ELFOBJ
 #define ELFOBJ 1
 #endif
@@ -156,6 +157,7 @@
     char isFreeBSD;     // generate code for FreeBSD
     char isOPenBSD;     // generate code for OpenBSD
     char isSolaris;     // generate code for Solaris
+    char isHitomi;      // generate code for Hitomi
     char scheduler;     // which scheduler to use
     char useDeprecated; // allow use of deprecated features
     char useAssert;     // generate runtime code for assert()'s
diff -r 748ce286f58f d/dmd2/mtype.c
--- a/d/dmd2/mtype.c	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/dmd2/mtype.c	Fri Sep 09 23:26:27 2011 +0200
@@ -86,7 +86,7 @@
 int REALSIZE = 16;
 int REALPAD = 6;
 int REALALIGNSIZE = 16;
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
 int REALSIZE = 12;
 int REALPAD = 2;
 int REALALIGNSIZE = 4;
@@ -285,7 +285,7 @@
     if (global.params.isX86_64)
     {
         PTRSIZE = 8;
-        if (global.params.isLinux || global.params.isFreeBSD || global.params.isSolaris)
+        if (global.params.isLinux || global.params.isFreeBSD || global.params.isSolaris || global.params.isHitomi)
         {
             REALSIZE = 16;
             REALPAD = 6;
@@ -300,7 +300,7 @@
 #if TARGET_OSX
         REALSIZE = 16;
         REALPAD = 6;
-#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#elif TARGET_LINUX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
         REALSIZE = 12;
         REALPAD = 2;
 #else
@@ -2529,7 +2529,7 @@
             sz = REALALIGNSIZE;
             break;
 
-#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX
+#if TARGET_LINUX || TARGET_OSX || TARGET_FREEBSD || TARGET_OPENBSD || TARGET_SOLARIS || TARGET_UNIX || TARGET_HITOMI
         case Tint64:
         case Tuns64:
             sz = global.params.isX86_64 ? 8 : 4;
diff -r 748ce286f58f d/target-ver-syms.sh
--- a/d/target-ver-syms.sh	Sat Sep 03 12:00:14 2011 -0400
+++ b/d/target-ver-syms.sh	Fri Sep 09 23:26:27 2011 +0200
@@ -45,6 +45,7 @@
 sysv4*) d_os_versym=sysv4; d_unix=1 ;;
 *bsd*) d_os_versym=bsd; d_unix=1 ;;
 gnu*) d_os_versym=hurd; d_unix=1 ;;
+hitomi*) d_os_versym=hitomi; d_unix=1 ;;
 
 *) d_os_versym="$d_target_os"
 esac
@@ -90,5 +91,6 @@
 openbsd) echo "#define TARGET_OPENBSD 1" ;;
 solaris) echo "#define TARGET_SOLARIS 1" ;;
 Win32)   echo "#define TARGET_WINDOS  1" ;;
+hitomi)  echo "#define TARGET_HITOMI  1" ;;
 *)       echo "#define TARGET_UNIX    1" ;;
 esac
